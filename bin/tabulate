#!/usr/bin/env ruby
# frozen_string_literal: true

require 'json'

require_relative '../lib/twenty_48'

puts %w(board_size max_exponent max_end_state_moves states size).join(',')

def tabulate(model)
  hash = model.build_hash_model
  puts [
    model.board_size,
    model.max_exponent,
    model.max_end_state_moves,
    hash.size,
    JSON.dump(hash).size
  ].join(',')
end

(2..7).each do |max_exponent|
  (0..[max_exponent - 1, 3].min).each do |max_end_state_moves|
    tabulate(Twenty48::Model.new(2, max_exponent, max_end_state_moves))
  end
end

(2..4).each do |max_exponent|
  (0..[max_exponent - 1, 3].min).each do |max_end_state_moves|
    tabulate(Twenty48::Model.new(3, max_exponent, max_end_state_moves))
  end
end

# (2..3).each do |max_exponent|
#  tabulate(Twenty48::Model.new(4, max_exponent))
# end
#
# out of time / memory: at least 1446235 states
# tabulate(Twenty48::Model.new(4, 4, true))
